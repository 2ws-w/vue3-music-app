import{_ as F,d as P,m as A,n as R,r as T,l as x,q as V,o as J,a as _,c as p,b as o,t as r,g as a,F as C,e as k,p as K,h as O,s as Q}from"./index.cbd5cf29.js";import{G as f,a as X,b as Y}from"./apis.02f66e57.js";const Z=y=>(K("data-v-75fe3f22"),y=y(),O(),y),ee={class:"musicdetil"},te={class:"title"},se={class:"songname"},oe={class:"singer"},ne=["src"],ce=["src"],ie={class:"gecihezi"},le={class:"geci"},re={class:"hotcomment"},ae=Z(()=>o("h1",null,"\u70ED\u95E8\u8BC4\u8BBA",-1)),ue={class:"item"},de={class:"left"},me=["src"],he={class:"right"},ge={class:"pinglun"},_e={class:"username"},pe={class:"comment"},fe={class:"information"},ye={class:"timeStr"},ve={class:"likedCount"},Se=P({name:"MusicDetail",setup(y){const M=A(),l=R().query.id;let v=0,S=0,q=70,u=T(),d=T();x([]);let L=T({}),i=x({song:"",stime:"",singer:"",picurl:"",lyric:""}),w=T("");const H=e=>{let s=Math.floor(e/60);s<10&&(s="0"+s);let t=Math.floor(e%60);return t<10&&(t="0"+t),`${s}:${t}`},D=()=>{const e=document.querySelector(".slide"),s=document.querySelector(".fill");document.querySelector(".point"),setInterval(function(){f(l).then(t=>{t.data.songs[0].dt/1e3;let n=e.offsetWidth;if(s.offsetWidth<n){let g=document.querySelector("audio").currentTime,h=Math.floor(g/60),G=h>=10?h:"0"+h,I=Math.ceil(g)%60,N=I>=10?I:"0"+I;const $=document.querySelector(".currentTimem"),j=document.querySelector(".currentTimes");$.innerHTML=G,j.innerHTML=N}})},1e3)};document.querySelector("audio");const E=setInterval(function(){const e=document.querySelector(".songimg"),s=document.querySelector(".slide"),t=document.querySelector(".fill"),n=document.querySelector(".point");M.IsPause?(v+=0,e.style.transform="rotate("+v+"deg)",f(l).then(c=>{c.data.songs[0].dt/1e3,s.offsetWidth,t.offsetWidth,S+=0,t.style.width=S+"px",q+=0,n.style.left=q+"px"})):(v+=4,e.style.transform="rotate("+v+"deg)",f(l).then(c=>{let m=c.data.songs[0].dt/1e3,h=s.offsetWidth/m/10;t.offsetWidth,S+=h,t.style.width=S+"px",q+=h,n.style.left=q+"px"}))},100);let B=x([]);const W=()=>{f(l).then(e=>{i.song=e.data.songs[0].name,i.stime=e.data.songs[0].dt,i.singer=e.data.songs[0].ar[0].name,i.picurl=e.data.songs[0].al.picUrl,d.value=parseInt(i.stime/1e3/60),u.value=parseInt(i.stime/1e3%60),d.value>=10?d.value:d.value="0"+d.value,u.value>=10?u.value:u.value="0"+u.value,document.querySelector(".currentTime");const s=document.querySelector(".duraTimem"),t=document.querySelector(".duraTimes");s.innerHTML=d.value,t.innerHTML=u.value})},b=()=>{X(l).then(e=>{i.lyric=e.data.lrc.lyric;let s={},t=/\[(.*?)](.*)/g;i.lyric.replace(t,(c,m,g)=>{m=m.slice(0,5),s[m]=g}),L.value=s;const n=document.querySelector("audio");n.ontimeupdate=()=>{let c=H(n.currentTime);c in s&&(w.value=c),U(),D()}})},U=()=>{let e=document.getElementsByClassName("highlight")[0];document.querySelector(".geci");const s=document.querySelector(".gecihezi");e&&e.offsetTop>=30&&(s.scrollTop=e.offsetTop-130)},z=()=>{Y(l).then(e=>{B.push(e.data.hotComments)})};return f(l).then(e=>{console.log(e.data.privileges);const s=document.querySelector(".thumbnail");let t=e.data.songs[0].al.picUrl;s.src=t;const n=document.querySelector(".currentSinger"),c=document.querySelector(".currentSongName");n.innerHTML=e.data.songs[0].ar[0].name,c.innerHTML=e.data.songs[0].al.name}),V(()=>{console.log("onBeforeUnmount"),clearInterval(E);const e=document.querySelector(".ppbtn");e.innerHTML="\uE947",M.PauseMusic(M)}),J(()=>{W(),b(),z(),console.log("\u6536\u5230\u7684id",l)}),(e,s)=>(_(),p("div",ee,[o("div",te,[o("div",se,r(a(i).song),1),o("div",oe,r(a(i).singer),1)]),o("audio",null,[o("source",{src:`https://music.163.com/song/media/outer/url?id=${a(l)}.mp3`},null,8,ne)]),o("img",{src:a(i).picurl,alt:"",class:"songimg"},null,8,ce),o("div",ie,[o("div",le,[(_(!0),p(C,null,k(a(L),(t,n,c)=>(_(),p("p",{class:Q(["lyric",a(w)==n?"highlight":" "]),key:c},r(t),3))),128))])]),o("div",re,[ae,(_(!0),p(C,null,k(a(B)[0],(t,n)=>(_(),p("div",{class:"comments",key:n},[o("div",ue,[o("div",de,[o("img",{class:"usertx",src:t.user.avatarUrl,alt:""},null,8,me)]),o("div",he,[o("div",ge,[o("span",_e,r(t.user.nickname)+":",1),o("span",pe,r(t.content),1)]),o("div",fe,[o("span",ye,r(t.timeStr),1),o("span",ve,"\uE941"+r(t.likedCount),1)])])])]))),128))])]))}});var Ie=F(Se,[["__scopeId","data-v-75fe3f22"]]);export{Ie as default};
